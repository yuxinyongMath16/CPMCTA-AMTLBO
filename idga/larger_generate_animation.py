# -*- coding:utf-8 -*-

"""
作者：yuxinyong
日期：2022年10月17日
"""
import generate_animation
import task_assignment
import chromosome_generation
import MAP
import math


airport = [[[42000, 18000], 16, math.pi/2, 2], [[3000, 18000], 60, math.pi/2, 3], [[45000, 50000], 0, math.pi, 1],
           [[30000, 5000], 50, 3*math.pi/4, 3]]
Uav = [[[42000, 18000], 1, 80, 0, 250], [[42000, 18000], 3, 60, 5, 220], [[3000, 18000], 3, 70, 5, 210],
       [[3000, 18000], 1, 80, 0, 240], [[45000, 50000], 2, 70, 3, 200, 3], [[45000, 50000], 3, 80, 4, 220],
       [[30000, 5000], 2, 70, 2, 200], [[30000, 5000], 1, 80, 0, 250, 3]]
obstacles = [[1, [[10000, 15000], 2000]], [1, [[15000, 35000], 5000]], [1, [[45000, 25000], 1000]],
             [1, [[30000, 15000], 2000]], [1, [[35000, 45000], 1500]], [1, [[58000, 35000], 2000]],
             [2, [[30000, 25000], [35000, 27000], [38000, 31000], [33000, 35000], [26000, 30000]]],
             [2, [[18000, 21000], [23000, 22000], [24000, 25000], [19000, 26000]]],
             [2, [[58000, 20000], [61500, 22000], [61000, 25000], [56000, 26000], [52000, 23500], [53500, 21000]]],
             [2, [[42000, 42000], [52000, 41000], [49000, 46000], [45000, 47000]]]]

target = [[[25000, 36000], [1, 2, 3], 40], [[5000, 20000], [1, 2, 3], 60], [[47500, 30000], [1, 2, 3], 40],
          [[2500, 45000], [1, 2, 3], 80], [[20000, 15000], [1, 2, 3], 80], [[58000, 18000], [1, 2, 3], 80],
          [[16000, 49000], [1, 2, 3], 60], [[40000, 18000], [1, 2, 3], 60], [[47000, 52000], [1, 2, 3], 80],
          [[30000, 19500], [1, 2, 3], 60], [[30000, 2000], [1, 2, 3], 40], [[32000, 58000], [1, 2, 3], 90],
          [[61000, 42000], [1, 2, 3], 80], [[70000, 52000], [1, 2, 3], 90], [[68000, 32000], [1, 2, 3], 80],
          [[71000, 19000], [1, 2, 3], 80]]
targets = []
uavs = []
airports = []
Obstacles = []
for i in range(len(airport)):
    c_air = chromosome_generation.Airport(i + 1, airport[i][0], airport[i][1], airport[i][2], airport[i][3])
    airports.append(c_air)
for i in range(len(target)):
    c_tar = chromosome_generation.Target(i + 1, target[i][0], target[i][1], target[i][2])
    targets.append(c_tar)
for i in range(len(Uav)):
    c_uav = chromosome_generation.UAV(i + 1, Uav[i][0], Uav[i][1], Uav[i][2], Uav[i][3], Uav[i][4], airports)
    uavs.append(c_uav)
for obstacle in obstacles:
    if obstacle[0] == 1:
        Obs = MAP.Obstacle('o', obstacle[1])
    else:
        Obs = MAP.Obstacle('p', obstacle[1])
    Obstacles.append(Obs)

optimal_value = 1462.0572776547042
optimal_chromosome = [[5, 1, 1], [15, 1, 1], [16, 1, 1], [14, 1, 1], [3, 1, 1], [14, 3, 1], [16, 3, 1], [10, 1, 1], [3, 3, 1], [8, 3, 1], [5, 2, 2], [4, 2, 2], [10, 2, 2], [9, 2, 2], [12, 2, 3], [6, 2, 3], [15, 2, 3], [16, 2, 3], [14, 2, 3], [2, 1, 4], [4, 1, 4], [11, 1, 4], [6, 1, 4], [5, 3, 4], [1, 1, 4], [11, 3, 4], [4, 3, 4], [1, 3, 4], [12, 1, 5], [3, 2, 5], [9, 3, 5], [2, 2, 6], [11, 2, 6], [13, 2, 6], [7, 2, 6], [1, 2, 7], [8, 1, 7], [6, 3, 7], [8, 2, 7], [10, 3, 7], [9, 1, 8], [13, 1, 8], [7, 1, 8], [13, 3, 8], [15, 3, 8], [2, 3, 8], [7, 3, 8], [12, 3, 8]]
return_airport = [[1, [42000, 37827], 1239.2122626779167, 1], [1, [42000, 29439], 714.9248539913754, 2], [2, [3000, 89212], 1186.859871044153, 3], [2, [3000, 102405], 1406.7417580663716, 4], [3, [45000, 50000], 370.3229047821487, 5], [3, [45000, 50000], 937.9151312677782, 6], [4, [8674, 26326], 603.1806914453375, 7], [4, [-16544, 51544], 1316.4636172919588, 8]]

# generate_animation.track_map(optimal_chromosome, uavs, targets, airports, Obstacles, return_airport, optimal_value)
task_assignment.track_map(optimal_chromosome, uavs, targets, airports, Obstacles, return_airport)